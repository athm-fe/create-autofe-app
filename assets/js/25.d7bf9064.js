(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{234:function(t,s,a){"use strict";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"环境变量和模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境变量和模式"}},[t._v("#")]),t._v(" 环境变量和模式")]),t._v(" "),s("p",[t._v("你可以替换你的项目根目录中的下列文件来指定环境变量：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v(".env                "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在所有的环境中被载入")]),t._v("\n.env.local          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在所有的环境中被载入，但会被 git 忽略")]),t._v("\n.env."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("         "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只在指定的模式中被载入")]),t._v("\n.env."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mode"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(".local   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只在指定的模式中被载入，但会被 git 忽略")]),t._v("\n")])])]),s("p",[t._v("一个环境文件只包含环境变量的“键=值”对：")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("FOO=bar\nAPP_SECRET=secret\n")])])]),s("p",[t._v("被载入的变量将会被 "),s("code",[t._v("autofe-scripts")]),t._v(" 内部访问到。")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("环境加载属性")]),t._v(" "),s("p",[t._v("为一个特定模式准备的环境文件的 (例如 "),s("code",[t._v(".env.production")]),t._v(") 将会比一般的环境文件 (例如 "),s("code",[t._v(".env")]),t._v(") 拥有更高的优先级。")]),t._v(" "),s("p",[t._v("此外，Creator 启动时已经存在的环境变量拥有最高优先级，并不会被 "),s("code",[t._v(".env")]),t._v(" 文件覆写。")])]),t._v(" "),s("h2",{attrs:{id:"模式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模式"}},[t._v("#")]),t._v(" 模式")]),t._v(" "),s("p",[s("strong",[t._v("模式")]),t._v("是 Creator 项目中一个重要的概念。默认情况下，一个 Creator 项目有两个模式：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("development")]),t._v(" 模式用于 "),s("code",[t._v("autofe-scripts start")])]),t._v(" "),s("li",[s("code",[t._v("production")]),t._v(" 模式用于 "),s("code",[t._v("autofe-scripts build")])])]),t._v(" "),s("p",[t._v("注意模式不同于 "),s("code",[t._v("NODE_ENV")]),t._v("，一个模式可以包含多个环境变量。也就是说，每个模式都会将 "),s("code",[t._v("NODE_ENV")]),t._v(" 的值设置为模式的名称——比如在 development 模式下 "),s("code",[t._v("NODE_ENV")]),t._v(" 的值会被设置为 "),s("code",[t._v('"development"')]),t._v("。")]),t._v(" "),s("p",[t._v("你可以通过为 "),s("code",[t._v(".env")]),t._v(" 文件增加后缀来设置某个模式下特有的环境变量。比如，如果你在项目根目录创建一个名为 "),s("code",[t._v(".env.development")]),t._v(" 的文件，那么在这个文件里声明过的变量就只会在 development 模式下被载入。")]),t._v(" "),s("h2",{attrs:{id:"在客户端侧代码中使用环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在客户端侧代码中使用环境变量"}},[t._v("#")]),t._v(" 在客户端侧代码中使用环境变量")]),t._v(" "),s("p",[t._v("只有以 "),s("code",[t._v("APP_")]),t._v(" 开头的变量会被 "),s("code",[t._v("webpack.DefinePlugin")]),t._v(" 静态嵌入到客户端侧的包中。你可以在应用的代码中这样访问它们：")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("APP_SECRET")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("在构建过程中，"),s("code",[t._v("process.env.APP_SECRET")]),t._v(" 将会被相应的值所取代。在 "),s("code",[t._v("APP_SECRET=secret")]),t._v(" 的情况下，它会被替换为 "),s("code",[t._v('"secret"')]),t._v("。")]),t._v(" "),s("p",[t._v("除了 "),s("code",[t._v("APP_*")]),t._v(" 变量之外，在你的应用代码中始终可用的还有两个特殊的变量：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("NODE_ENV")]),t._v(" - 会是 "),s("code",[t._v('"development"')]),t._v("、"),s("code",[t._v('"production"')]),t._v(" 中的一个。具体的值取决于应用运行的"),s("a",{attrs:{href:"#%E6%A8%A1%E5%BC%8F"}},[t._v("模式")]),t._v("。")]),t._v(" "),s("li",[s("code",[t._v("BASE_URL")]),t._v(" - 会和 "),s("code",[t._v("creator.config.js")]),t._v(" 中的 "),s("code",[t._v("publicPath")]),t._v(" 选项相符，即你的应用会部署到的基础路径。")])]),t._v(" "),s("p",[t._v("所有解析出来的环境变量也可以在 JavaScript、HTML 和 SASS 中使用。")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),s("p",[t._v("你可以在 "),s("code",[t._v("creator.config.js")]),t._v(" 文件中计算环境变量。它们仍然需要以 "),s("code",[t._v("APP_")]),t._v(" 前缀开头。这可以用于版本信息 "),s("code",[t._v("process.env.APP_VERSION = require('./package.json').version")]),t._v("。")])]),t._v(" "),s("h3",{attrs:{id:"javascript"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#javascript"}},[t._v("#")]),t._v(" JavaScript")]),t._v(" "),s("div",{staticClass:"language-javascript extra-class"},[s("pre",{pre:!0,attrs:{class:"language-javascript"}},[s("code",[t._v("console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("BASE_URL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NODE_ENV")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("env"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token constant"}},[t._v("APP_TEST_ENV_FEATURE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"html"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#html"}},[t._v("#")]),t._v(" HTML")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{ APP_TEST_ENV_FEATURE }}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n{% if NODE_ENV === 'development' %}\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("这是只出现在开发环境的内容"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n{% else %}\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("这是只出现在生产环境的内容"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n{% endif %}\n")])])]),s("h3",{attrs:{id:"sass"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sass"}},[t._v("#")]),t._v(" SASS")]),t._v(" "),s("div",{staticClass:"language-scss extra-class"},[s("pre",{pre:!0,attrs:{class:"language-scss"}},[s("code",[s("span",{pre:!0,attrs:{class:"token selector"}},[t._v(".box ")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("background-image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token url"}},[t._v("url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("#{$BASE_URL}")]),t._v("/img/logo.png"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("content")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$APP_TEST_ENV_FEATURE")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"只在本地有效的变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#只在本地有效的变量"}},[t._v("#")]),t._v(" 只在本地有效的变量")]),t._v(" "),s("p",[t._v("有的时候你可能有一些不应该提交到代码仓库中的变量，尤其是当你的项目托管在公共仓库时。这种情况下你应该使用一个 "),s("code",[t._v(".env.local")]),t._v(" 文件取而代之。本地环境文件默认会被忽略，且出现在 "),s("code",[t._v(".gitignore")]),t._v(" 中。")]),t._v(" "),s("p",[s("code",[t._v(".local")]),t._v(" 也可以加在指定模式的环境文件上，比如 "),s("code",[t._v(".env.development.local")]),t._v(" 将会在 development 模式下被载入，且被 git 忽略。")])])}),[],!1,null,null,null);s.default=e.exports}}]);